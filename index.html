<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Quiz Slide</title>
    
    <link rel="stylesheet" href="node_modules/reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="reveal">
        <div class="slides">
            <!-- Markdownファイルを読み込む -->
            <section data-markdown="quiz.md"
                     data-separator="^\r?\n---\r?\n"
                     data-separator-vertical="^\r?\n>>>\r?\n"
            >
            </section>
        </div>
    </div>

    <script type="module">
        import Reveal from './node_modules/reveal.js/dist/reveal.esm.js';
        import Markdown from './node_modules/reveal.js/plugin/markdown/markdown.esm.js';
        import QuaggaPlugin from './plugin/quagga.js';
        import { startCountdown } from './lib/countdown.js';
        import { copyPreviousSlide } from './lib/copy-slide.js';
        
        // Reveal.jsを初期化
        Reveal.initialize({
            controls: false,
            progress: false,
            hash: true,
            // 4:3比率の設定
            width: 800, height: 600,
            margin: 0,
            minScale: 1,
            maxScale: 1,
            center: true,
            disableLayout: false,
            transition: 'none',
            autoPlayMedia: true,
            // プラグインを有効化
            plugins: [ Markdown, QuaggaPlugin ]
        });

        // スライド変更時のイベントハンドラーを設定
        Reveal.on('slidechanged', (event) => {
            const state = event.currentSlide.dataset.state;
            console.log(state);
            if (state === 'with-timer') {
                startCountdown();
            } else if (state === 'copy-prev') {
                copyPreviousSlide(Reveal);
            }
        });
    </script>
</body>
</html>